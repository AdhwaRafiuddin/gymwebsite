<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Log Workout</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
body {
    background: linear-gradient(135deg, #798777, #6c7a6a);
    color: #F8EDE3;
    min-height: 100vh;
}

.navbar {
    background-color: #A2B29F;
    box-shadow: 0 3px 10px rgba(0,0,0,0.2);
}

.navbar-brand {
    color: #F8EDE3 !important;
    font-weight: 800;
}

.card {
    background-color: #A2B29F;
    border: none;
    box-shadow: 0 10px 25px rgba(0,0,0,0.25);
    border-radius: 18px;
    padding: 25px;
    margin-bottom: 20px;
}

label {
    font-weight: 700;
    margin-bottom: 6px;
}

.form-control, .form-select {
    background-color: #B5C7B3;
    border: none;
    border-radius: 10px;
    padding: 10px;
    font-weight: 600;
    color: #2f3b2f;
}

.exercise-card {
    background-color: #B5C7B3;
    border-radius: 14px;
    padding: 15px;
    margin-bottom: 12px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.exercise-info {
    display: flex;
    align-items: center;
    flex-wrap: wrap;
    gap: 8px;
    font-weight: 700;
    color: #2f3b2f;
}

.exercise-info input {
    width: 85px;
    border-radius: 8px;
    border: none;
    padding: 4px 6px;
}

.btn-custom {
    background-color: #F8EDE3;
    color: #798777;
    font-weight: 800;
    border-radius: 16px;
    padding: 12px 30px;
    margin-top: 15px;
}

.btn-custom:hover {
    background-color: #BDD2B6;
}

.group-title {
    font-weight: 800;
    color: #2f3b2f;
    margin-top: 20px;
    margin-bottom: 10px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

</style>
</head>

<body>

<nav class="navbar navbar-dark px-3">
    <a href="index.html" class="navbar-brand">â¬… Back</a>
    <span class="navbar-text fw-bold">Log Workout</span>
</nav>

<div class="container my-4">
    <div class="card">

        <div class="mb-3">
            <label>Select Person</label>
            <select id="personSelect" class="form-select">
                <option value="Adhwa">Adhwa</option>
                <option value="Ainaa">Ainaa</option>
            </select>
        </div>

        <div class="mb-3">
            <label>Workout Date</label>
            <input type="date" id="workoutDate" class="form-control">
        </div>

        <div class="mb-3">
            <label>Select Day Type</label>
            <select id="dayType" class="form-select" onchange="loadRoutine()">
                <option value="">-- Select --</option>
                <option value="Push">Push</option>
                <option value="Pull">Pull</option>
                <option value="Legs">Legs</option>
            </select>
        </div>

        <h5 class="fw-bold mb-3">Exercises</h5>
        <div id="exerciseContainer"></div>

        <button id="saveBtn" class="btn btn-custom w-100" onclick="saveWorkout()">
            Save Workout ðŸ’ª
        </button>

    </div>
</div>

<!-- ðŸ”¥ Firebase Setup -->
<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyAPy4J2VvWVbTjzKPGhr5YkfYwwL7Ai6B4",
  authDomain: "gymwebsite-tracker.firebaseapp.com",
  projectId: "gymwebsite-tracker",
  storageBucket: "gymwebsite-tracker.firebasestorage.app",
  messagingSenderId: "1048952192948",
  appId: "1:1048952192948:web:b77466f54c26e8f74c7ce1"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

window.db = db;
window.collection = collection;
window.addDoc = addDoc;

</script>

<script>

const routines = {
    Push: {
        Chest: ["Bench Press","Incline Dumbbell Press"],
        Shoulders: ["Overhead Press"],
        Triceps: ["Triceps Pushdown"]
    },
    Pull: {
        Back: ["Pull-Ups","Barbell Row","Face Pulls"],
        Biceps: ["Bicep Curl"]
    },
    Legs: {
        Legs: ["Squat","Deadlift","Lunges","Leg Curl"]
    }
};

document.getElementById("workoutDate").value =
    new Date().toISOString().slice(0,10);

function loadRoutine() {
    const dayType = document.getElementById("dayType").value;
    const container = document.getElementById("exerciseContainer");
    container.innerHTML = "";
    if(!dayType) return;

    const dayGroups = routines[dayType];

    for(const group in dayGroups) {

        const groupDiv = document.createElement("div");

        groupDiv.innerHTML = `
            <div class="group-title">
                <span>${group}</span>
                <button class="btn btn-sm btn-outline-light"
                    onclick="promptAddExercise('${group}')">
                    âž• Add
                </button>
            </div>
        `;

        const groupContainer = document.createElement("div");
        groupContainer.id = `group-${group}`;
        groupDiv.appendChild(groupContainer);
        container.appendChild(groupDiv);

        dayGroups[group].forEach(ex =>
            addExercise(ex, groupContainer));
    }
}

function addExercise(name="", container=null) {
    if(!container)
        container = document.getElementById("exerciseContainer");

    const div = document.createElement("div");
    div.classList.add("exercise-card");

    div.innerHTML = `
        <div class="exercise-info">
            <span>${name}</span>
            <input class="sets" type="number" placeholder="Sets" min="0">
            <input class="reps" type="text" placeholder="Reps">
            <input class="weight" type="number" placeholder="Kg" min="0">
        </div>
        <button class="btn btn-sm btn-outline-danger"
            onclick="this.closest('.exercise-card').remove()">
            Delete
        </button>
    `;

    container.appendChild(div);
}

function promptAddExercise(group) {
    const container = document.getElementById(`group-${group}`);
    const name = prompt(`Enter exercise name for ${group}:`);
    if(name && name.trim() !== "")
        addExercise(name.trim(), container);
}

  async function saveWorkout() {
    const user = document.getElementById("userSelect").value;
    const day = document.getElementById("daySelect").value;
    const date = document.getElementById("dateInput").value;

    const exercises = [];

    document.querySelectorAll(".exercise-card").forEach(card => {
      const name = card.querySelector(".exercise-name").value;
      const sets = card.querySelector(".exercise-sets").value;
      const reps = card.querySelector(".exercise-reps").value;
      const weight = card.querySelector(".exercise-weight").value;

      if (name) {
        exercises.push({
          name,
          sets,
          reps,
          weight
        });
      }
    });

    if (!date) {
      alert("Please select a date.");
      return;
    }

    try {
      await addDoc(collection(db, "workouts"), {
        user,
        day,
        date,
        exercises,
        createdAt: new Date()
      });

      alert("Workout saved to Firebase ðŸ’ªðŸ”¥");
      location.reload();

    } catch (error) {
      console.error("Error saving workout: ", error);
      alert("Something went wrong.");
    }
  }

  document.getElementById("saveBtn").addEventListener("click", saveWorkout);
</script>


</body>
</html>
